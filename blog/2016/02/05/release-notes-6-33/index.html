<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Finagle 6.33 Release Notes</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="author" content="" />

    <link href="/assets/css/bootstrap.css" rel="stylesheet">
    <link href="/assets/css/bootstrap-theme.css" rel="stylesheet">
    <link href="/assets/css/font-awesome.css" rel="stylesheet">
    <link href="/assets/css/syntax.css" rel="stylesheet">
    <link rel="icon" type="image/png" href="/favicon.png">
    <link href="../../../../../assets/css/main.css" rel="stylesheet" type="text/css" />

    <!-- JS -->
    <script type="text/javascript" src="/assets/js/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="/assets/js/bootstrap.js"></script>

    <link type="application/atom+xml" rel="alternate" href="/blog/feed.xml" />


    <!-- Google Analytics Magic -->
    <script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-39101739-6', 'finagle.github.io');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <!-- navbar excitement -->
    <div class="navbar navbar-custom navbar-static-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-right navbar-nav">
            <li><a href="https://twitter.github.io/finagle/">Project</a></li>
            <li><a href="https://github.com/finagle/">Ecosystem</a></li>
            <li class="dropdown">
              <a href="https://twitter.github.io/finagle/">Learn more <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
                <li role="presentation"><a role="menuitem" tabindex="-1" href="http://twitter.github.io/finagle/guide/">
                  <i class="fa fa-book"></i> User's guide</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="http://twitter.github.io/finagle/guide/Quickstart.html">
                  <i class="fa fa-check-square-o"></i> Quickstart</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://github.com/twitter/finagle/blob/master/ADOPTERS.md">
                  <i class="fa fa-smile-o"></i> Adopters</a>
                </li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="https://github.com/twitter/finagle">Get involved <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://github.com/twitter/finagle">
                  <i class="fa fa-github-alt"></i> Source</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://github.com/twitter/finagle/blob/master/CONTRIBUTING.md">
                  <i class="fa fa-code-fork"></i> Contributing</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://twitter.com/finagle">
                  <i class="fa fa-twitter"></i> @finagle</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://groups.google.com/forum/#!forum/finaglers">
                  <i class="fa fa-envelope"></i> Mailing list</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="http://stackoverflow.com/questions/tagged/finagle">
                  <i class="fa fa-stack-overflow"></i> Stack Overflow</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://github.com/finagle/finagle.github.io/">
                  <i class="fa fa-pencil"></i> Write a blog post!</a>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div><!-- /.navbar -->
    <div class="container">
      <div class="row">

<div class="col-md-3">
  <div><a href="/" class="logo"><img src="/assets/img/finagle_logo_small.png" alt="Finagle" /></a></div>
  <div class="meta">
    <!---->
    <div class="author-contact">
      <h4 class="author-name">Vladimir Kostyukov</h4>
      <p class="author-twitter"><a href="https://twitter.com/vkostyukov">@vkostyukov</a></p>
    </div>
    <p><em>Posted February  5, 2016</em></p>
  </div>
  
  <div class="share">
    <span class="social-share-button"><a href="https://twitter.com/share" class="twitter-share-button" data-via="finagle">Tweet</a></span>
    
    <span><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script></span>
  </div>
</div>

<div class="post col-md-9">
  <h1>Finagle 6.33 Release Notes</h1>
  
  <p>In this milestone, we&rsquo;ve been focusing on two major directions:</p>

<ol>
<li>Improving the user experience by providing friendly APIs and updating docs</li>
<li>Continuing to improve Finagle&rsquo;s resiliency</li>
</ol>

<h3>Discoverable Params</h3>

<p>There is a new user-friendly API for configuring Finagle clients and servers using <code>with</code>-prefixed
methods (<code>.withClientId</code>, <code>.withStatsReceiver</code>, etc). Discoverable configuration parameters are a
modern alternative to ClientBuilder/ServerBuilder which provides an easy to use, type safe, and IDE
discoverable API on top of <code>$Protocol.{client,server}.configured</code> through a collection of
<code>with</code>-prefixed methods available on both clients and servers. It’s already in master and we
encourage you to open your favorite IDE and type <code>client.with</code> or <code>server.with</code> and start discovering.</p>

<p>Example:</p>
<pre class="highlight scala"><code><span class="k">import</span> <span class="nn">com.twitter.finagle.Http</span>
<span class="k">import</span> <span class="nn">com.twitter.conversions.time._</span>

<span class="nc">Http</span><span class="o">.</span><span class="n">client</span>
  <span class="o">.</span><span class="n">withLabel</span><span class="o">(</span><span class="s">"http-client"</span><span class="o">)</span>
  <span class="o">.</span><span class="n">withSessionQualifier</span><span class="o">.</span><span class="n">noFailFast</span>
  <span class="o">.</span><span class="n">withSession</span><span class="o">.</span><span class="n">acquisitionTimeout</span><span class="o">(</span><span class="mf">10.</span><span class="n">seconds</span><span class="o">)</span>
</code></pre>

<p>See it in action!</p>

<p><center><img src="http://i.imgur.com/yIE7iy8.gif" /></center></p>

<p>We thought carefully about how to make these clear and easy to use. If you&rsquo;re curious about the
design, please feel free to take a look at the <a href="http://twitter.github.io/finagle/guide/Configuration.html#design-principles">design principles</a>.</p>

<p>The new API is fully documented so that every method has an up-to-date scaladoc comment explaining
the parameters it configures as well as mentioning their default values.</p>

<p>Also, it&rsquo;s worth mentioning that this API is 100% Java-friendly. You can now forget about
<code>new Param(...).mk(...)</code> and focus on what’s important–values, not the wrappers around them.</p>

<h3>New User Guide</h3>

<p>We updated/reworked <a href="http://twitter.github.io/finagle/guide/">Finagle’s User Guide</a> recently to capture the current state of
Finagle. For example, we updated both <a href="http://twitter.github.io/finagle/guide/Clients.html">Clients</a> and <a href="http://twitter.github.io/finagle/guide/Servers.html">Servers</a> with example
configurations of their modules.</p>

<h3>Response Classifiers</h3>

<p>Finagle’s new <a href="http://twitter.github.io/finagle/guide/Clients.html#response-classification">response classifiers</a> improve client’s avoidance of faulty nodes, and
thus, increase your success rate. To get this benefit, you must wire up the application’s rules into
your clients. There are already basic classifiers in Finagle available for HTTP and Thrift.</p>

<p>For example, the following configuration advises a Finagle client treat 500s HTTP responses as
non-retriable failures.</p>
<pre class="highlight scala"><code><span class="k">import</span> <span class="nn">com.twitter.finagle.Http</span>
<span class="k">import</span> <span class="nn">com.twitter.finagle.http.service.HttpResponseClassifier</span>

<span class="nc">Http</span><span class="o">.</span><span class="n">client</span>
  <span class="o">.</span><span class="n">withResponseClassifier</span><span class="o">(</span><span class="nc">HttpResponseClassifier</span><span class="o">.</span><span class="nc">ServerErrorsAsFailures</span><span class="o">)</span>
</code></pre>

<h3>Pending Requests Limit</h3>

<p>As part of our work on client-side admission control, there is a new client module maintaining the
limit of pending requests (i.e., requests that haven&rsquo;t been yet written to a wire). The limit is
unbounded by default.</p>

<p>In the following example, an HTTP client is configured to have at most 100 pending requests in the
queue. All requests on top of 100 will be rejected by a client.</p>
<pre class="highlight scala"><code><span class="k">import</span> <span class="nn">com.twitter.finagle.Http</span>

<span class="nc">Http</span><span class="o">.</span><span class="n">client</span>
  <span class="o">.</span><span class="n">withAdmissionControl</span><span class="o">.</span><span class="n">maxPendingRequests</span><span class="o">(</span><span class="mi">100</span><span class="o">)</span>
</code></pre>

<h3>Changelog</h3>

<ul>
<li><a href="https://github.com/twitter/finagle/blob/develop/CHANGES">Finagle 6.33</a></li>
<li><a href="https://github.com/twitter/util/blob/develop/CHANGES">Util 6.32</a></li>
<li><a href="https://github.com/twitter/scrooge/blob/develop/CHANGES">Scrooge 4.5</a></li>
<li><a href="https://github.com/twitter/twitter-server/blob/develop/CHANGES">TwitterServer 1.18</a></li>
<li><a href="https://github.com/twitter/ostrich/blob/develop/CHANGES">Ostrich 9.16</a></li>
</ul>

</div>
</div>

      <hr>
      <!-- footer -->
      <div class="footer pull-right">
        <p>&copy; 2014–2019 <a href="https://twitter.com/">Twitter, Inc.</a> and other contributors
      </div><!-- /footer -->
    </div><!-- /container -->
  </body>
</html>
