<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Summer Update ‚òÄÔ∏è</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="author" content="" />

    <link href="/assets/css/bootstrap.css" rel="stylesheet">
    <link href="/assets/css/bootstrap-theme.css" rel="stylesheet">
    <link href="/assets/css/font-awesome.css" rel="stylesheet">
    <link href="/assets/css/syntax.css" rel="stylesheet">
    <link rel="icon" type="image/png" href="/favicon.png">
    <link href="../../../../../assets/css/main.css" rel="stylesheet" type="text/css" />

    <!-- JS -->
    <script type="text/javascript" src="/assets/js/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="/assets/js/bootstrap.js"></script>

    <link type="application/atom+xml" rel="alternate" href="/blog/feed.xml" />


    <!-- Google Analytics Magic -->
    <script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-39101739-6', 'finagle.github.io');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <!-- navbar excitement -->
    <div class="navbar navbar-custom navbar-static-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-right navbar-nav">
            <li><a href="https://twitter.github.io/finagle/">Project</a></li>
            <li><a href="https://github.com/finagle/">Ecosystem</a></li>
            <li class="dropdown">
              <a href="https://twitter.github.io/finagle/">Learn more <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
                <li role="presentation"><a role="menuitem" tabindex="-1" href="http://twitter.github.io/finagle/guide/">
                  <i class="fa fa-book"></i> User's guide</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="http://twitter.github.io/finagle/guide/Quickstart.html">
                  <i class="fa fa-check-square-o"></i> Quickstart</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://github.com/twitter/finagle/blob/master/ADOPTERS.md">
                  <i class="fa fa-smile-o"></i> Adopters</a>
                </li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="https://github.com/twitter/finagle">Get involved <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://github.com/twitter/finagle">
                  <i class="fa fa-github-alt"></i> Source</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://github.com/twitter/finagle/blob/master/CONTRIBUTING.md">
                  <i class="fa fa-code-fork"></i> Contributing</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://twitter.com/finagle">
                  <i class="fa fa-twitter"></i> @finagle</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://groups.google.com/forum/#!forum/finaglers">
                  <i class="fa fa-envelope"></i> Mailing list</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="http://stackoverflow.com/questions/tagged/finagle">
                  <i class="fa fa-stack-overflow"></i> Stack Overflow</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://github.com/finagle/finagle.github.io/">
                  <i class="fa fa-pencil"></i> Write a blog post!</a>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div><!-- /.navbar -->
    <div class="container">
      <div class="row">

<div class="col-md-3">
  <div><a href="/" class="logo"><img src="/assets/img/finagle_logo_small.png" alt="Finagle" /></a></div>
  <div class="meta">
    <!---->
    <div class="author-contact">
      <h4 class="author-name">Christopher Coco</h4>
      <p class="author-twitter"><a href="https://twitter.com/cacoco">@cacoco</a></p>
    </div>
    <p><em>Posted July 26, 2019</em></p>
  </div>
  
  <div class="share">
    <span class="social-share-button"><a href="https://twitter.com/share" class="twitter-share-button" data-via="finagle">Tweet</a></span>
    
    <span><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script></span>
  </div>
</div>

<div class="post col-md-9">
  <h1>Summer Update ‚òÄÔ∏è</h1>
  
  <p>Hello Finaglers,</p>

<p>Summer ‚õ±Ô∏è is now in full-effect around the world üåç but we interrupt your travel üöôand ice cream üç¶ to quickly highlight the üÜí things released over the spring and early summer üêö months of April, May, and June. Just a note, if you‚Äôd like to keep up-to-date on all that is happening in a more real-time ‚è∞ fashion please feel free to watch ‚åö our project changelogs [<a href="https://github.com/twitter/util/blob/develop/CHANGELOG.rst">1</a>, <a href="https://github.com/twitter/scrooge/blob/develop/CHANGELOG.rst">2</a>, <a href="https://github.com/twitter/finagle/blob/develop/CHANGELOG.rst">3</a>, <a href="https://github.com/twitter/twitter-server/blob/develop/CHANGELOG.rst">4</a>, <a href="https://github.com/twitter/finatra/blob/develop/CHANGELOG.rst">5</a>].</p>

<p><strong>TwitterServer</strong></p>

<p>Users of TwitterServer can now <a href="https://github.com/twitter/twitter-server/commit/2c233bd5cc4590c7fa91de29c02a6424ad3a70fe">see client connections</a> to the server via the ‚Äú/admin/servers/connections.json‚Äù admin page.</p>

<p><strong>Streaming</strong></p>

<p>We‚Äôve continued rolling out Finagle streaming HTTP updates and improvements including adding more metrics for visibility including <a href="https://github.com/twitter/finagle/commit/916f4a2683aef99bc5e0c29bbdad0523cebb7bc1#diff-5e888bc17c6d0a91809c677e4b452c64">request/response streaming durations</a> and a new <a href="https://github.com/twitter/finagle/blob/develop/finagle-http/src/main/scala/com/twitter/finagle/http/filter/StreamingStatsFilter.scala"><code>StreamingStatsFilter</code></a> which tracks various <a href="http://twitter.github.io/finagle/guide/Metrics.html#streaming">request/response metrics</a>.</p>

<p><strong>Netty Upgrade</strong></p>

<p>We also <a href="https://github.com/twitter/finagle/commit/9ffbf7a74e53330672e45fd58baf07b623cc8348">upgraded</a> our Finagle Netty4 dependency to <a href="https://github.com/netty/netty/releases/tag/netty-4.1.35.Final">Netty 4.1.35.Final</a>.</p>

<p><strong>Finagle</strong></p>

<p>Have you wanted a way to easily shift your application work off of the I/O threads? Good news ‚Äî <a href="https://github.com/twitter/finagle/commit/40431bb43526efb7450a254e95baf52eda5dc997">now you can</a>. By default, Finagle executes all Futures in the I/O threads minimizing context switches. Since there is typically a fixed number of I/O threads shared across a JVM process, it is very important to ensure they‚Äôre not blocked by application code and thus affecting a system&rsquo;s responsiveness. Shifting application-level work onto a dedicated <code>FuturePool</code> or <code>ExecutorService</code> which offloads work from the I/O threads can improve throughput in CPU-bound systems. Note, you can also do this globally for your process by setting the <a href="http://twitter.github.io/finagle/guide/Flags.html#common"><code>com.twitter.finagle.offload.numWorkers</code> flag</a>.</p>

<p>Stats and retry modules use a <a href="https://twitter.github.io/finagle/guide/Clients.html#response-classification"><code>ResponseClassifier</code></a> to give hints for how to handle failure (e.g., Is this a success or is it a failure? If it&rsquo;s a failure, may I retry the request?). The StatsFilter increments a success counter for successes, or increments a failure counter for failures. There isn&rsquo;t a way to tell the stats module to just do nothing. But this is exactly what the StatsFilter should do (nothing) in the case of ignorable failures (e.g. backup request cancellations). To represent these cases, we introduce a new ResponseClass: <a href="https://github.com/twitter/finagle/blob/develop/finagle-core/src/main/scala/com/twitter/finagle/service/ResponseClass.scala#L49"><code>Ignorable</code></a>.</p>

<p><strong>Finagle-MySQL SSL/TLS</strong></p>

<p>The MySQL protocol contains support for SSL/TLS via messages sent when establishing a connection. However, <code>finagle-mysql</code> did not support the sending of the messages in the correct sequence in order to properly negotiate SSL/TLS with a MySQL server. We&rsquo;ve <a href="https://github.com/twitter/finagle/commit/0b6c20acc22267abe901c606352fb818e6345247#diff-d6f8b1cdbafc82ccae487a9b1f76478a">updated</a> <code>finagle-mysql</code> to now support using SSL/TLS with MySQL which can be enabled by calling <code>withTransport.tls(sslClientConfiguration)</code> on MySQL client and specifying a <code>c.t.f.ssl.client.SslClientConfiguration</code>.</p>

<p><strong>Jackson Upgrade</strong></p>

<p>We updated several of our libraries to <a href="https://github.com/FasterXML/jackson/wiki/Jackson-Release-2.9.8">Jackson 2.9.8</a> [<a href="https://github.com/twitter/util/commit/8840055958ad9adcc176ff6d0e4914f1f61730eb">1</a>, <a href="https://github.com/twitter/finagle/commit/90d5bcbfe87809f27bb24e2c4b4f9e3490b0d519">2</a>, <a href="https://github.com/twitter/twitter-server/commit/66c60483e94fb5d38e66641319ed94309c54df04">3</a>, <a href="https://github.com/twitter/finatra/commit/0a96d2caa9339675682f34d7889c6037ab104387">4</a>].</p>

<p><strong>Finatra</strong></p>

<p>Finatra‚Äôs HTTP integration uses code from the <code>javax.activation</code> library which was deprecated in JDK 9 and fully removed in JDK 11. We‚Äôve updated to <a href="https://github.com/twitter/finatra/commit/5a7ccf312f96f410ae0d96e77ba364faa460ccd8">specify an explicit dependency</a> on the 3rd party <code>com.sun.activation</code> library as a temporary measure until we can evolve the library away from using the <code>javax.activation</code> library. This allows for using Finatra HTTP services with JDK 11 without having to specify any additional dependencies.</p>

<p>Additionally, we‚Äôve made several changes to make testing more flexible. You can now <a href="https://github.com/twitter/finatra/commit/38a3180a5d61d12fb1546dd572f075cfd2fb3dbf">specify values for global flags</a> when creating an <code>EmbeddedTwitterServer</code>. This allows users to write tests which will not trample over each other since global flags are typically only read once on JVM startup.</p>

<p>We‚Äôve also updated the Finatra <code>EmbeddedTwitterServer</code> to allow users to <a href="https://github.com/twitter/finatra/commit/7a486fd28b3126ecb62ec209c51dd06721b24d5a">bring their own</a> <code>StatsReceiver</code> implementation. In testing with the <code>EmbeddedTwitterServer</code>, Finatra bound an <code>InMemoryStatsReceiver</code> instance to the object graph for any injectable <code>TwitterServer</code>. However this prevented users from being able to use and test against their own <code>StatsReceiver</code> implementation.</p>

<hr/>

<p>Thanks for following along. If you‚Äôd like to know more about any one of these updates, or if you have a question about them, join us on the <a href="https://groups.google.com/forum/#!forum/finaglers">Finagle</a> or <a href="https://groups.google.com/forum/#!forum/finatra-users">Finatra</a> mailing lists or hop on <a href="https://gitter.im/twitter/finagle">Gitter</a>.</p>

<p>Enjoy! üï∂Ô∏è</p>

<p>Christopher and the Core Systems Libraries team</p>

</div>
</div>

      <hr>
      <!-- footer -->
      <div class="footer pull-right">
        <p>&copy; 2014‚Äì2019 <a href="https://twitter.com/">Twitter, Inc.</a> and other contributors
      </div><!-- /footer -->
    </div><!-- /container -->
  </body>
</html>
