<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>February 2022 Release Notes - Version 22.2.0</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="author" content="" />

    <link href="/assets/css/bootstrap.css" rel="stylesheet">
    <link href="/assets/css/bootstrap-theme.css" rel="stylesheet">
    <link href="/assets/css/font-awesome.css" rel="stylesheet">
    <link href="/assets/css/syntax.css" rel="stylesheet">
    <link rel="icon" type="image/png" href="/favicon.png">
    <link href="../../../../../assets/css/main.css" rel="stylesheet" type="text/css" />

    <!-- JS -->
    <script type="text/javascript" src="/assets/js/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="/assets/js/bootstrap.js"></script>

    <link type="application/atom+xml" rel="alternate" href="/blog/feed.xml" />


    <!-- Google Analytics Magic -->
    <script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-39101739-6', 'finagle.github.io');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <!-- navbar excitement -->
    <div class="navbar navbar-custom navbar-static-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-right navbar-nav">
            <li><a href="https://twitter.github.io/finagle/">Project</a></li>
            <li><a href="https://github.com/finagle/">Ecosystem</a></li>
            <li class="dropdown">
              <a href="https://twitter.github.io/finagle/">Learn more <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
                <li role="presentation"><a role="menuitem" tabindex="-1" href="http://twitter.github.io/finagle/guide/">
                  <i class="fa fa-book"></i> User's guide</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="http://twitter.github.io/finagle/guide/Quickstart.html">
                  <i class="fa fa-check-square-o"></i> Quickstart</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://github.com/twitter/finagle/blob/master/ADOPTERS.md">
                  <i class="fa fa-smile-o"></i> Adopters</a>
                </li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="https://github.com/twitter/finagle">Get involved <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://github.com/twitter/finagle">
                  <i class="fa fa-github-alt"></i> Source</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://github.com/twitter/finagle/blob/master/CONTRIBUTING.md">
                  <i class="fa fa-code-fork"></i> Contributing</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://twitter.com/finagle">
                  <i class="fa fa-twitter"></i> @finagle</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://groups.google.com/forum/#!forum/finaglers">
                  <i class="fa fa-envelope"></i> Mailing list</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="http://stackoverflow.com/questions/tagged/finagle">
                  <i class="fa fa-stack-overflow"></i> Stack Overflow</a>
                </li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://github.com/finagle/finagle.github.io/">
                  <i class="fa fa-pencil"></i> Write a blog post!</a>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div><!-- /.navbar -->
    <div class="container">
      <div class="row">

<div class="col-md-3">
  <div><a href="/" class="logo"><img src="/assets/img/finagle_logo_small.png" alt="Finagle" /></a></div>
  <div class="meta">
    <!---->
    <div class="author-contact">
      <h4 class="author-name">Moses Nakamura</h4>
      <p class="author-twitter"><a href="https://twitter.com/mnnakamura">@mnnakamura</a></p>
    </div>
    <p><em>Posted March  4, 2022</em></p>
  </div>
  
  <div class="share">
    <span class="social-share-button"><a href="https://twitter.com/share" class="twitter-share-button" data-via="finagle">Tweet</a></span>
    
    <span><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script></span>
  </div>
</div>

<div class="post col-md-9">
  <h1>February 2022 Release Notes - Version 22.2.0</h1>
  
  <p>One of the joys of winter is drinking a mug of hot cocoa, curling up in a nook, and warming yourself by the heat of your computer compiling Scala code ‚òïüñ•Ô∏èüî•</p>

<p>We have a new release, and no houses were burned down in electrical fires while getting it to you.</p>

<h1><a href="https://github.com/twitter/util/">Util</a></h1>

<h2>New Features</h2>

<ul>
<li>  util-core: Added Memoize.classValue as a Scala-friendly API for java.lang.ClassValue. <a href="https://github.com/twitter/util/commit/b696fdfd9082fc7dfb3468f7aea84ce24677ef82">b696fdfd</a></li>
<li>  util-jvm: Register JVM expression including memory pool usages (including code cache, compressed class space,
eden space, sheap, metaspace, survivor space, and old gen) and open file descriptors count in StatsReceiver.
<a href="https://github.com/twitter/util/commit/ad617fe92445371dc5647add7a7143450492c137">ad617fe9</a></li>
<li>  util-slf4j-jul-bridge: Add Slf4jBridge trait which can be mixed into extensions of c.t.app.App in
order to attempt installation of the SLF4JBridgeHandler via the Slf4jBridgeUtility in the constructor
of the c.t.app.App instance. <a href="https://github.com/twitter/util/commit/ab73d64f95ceea48899e7561429d781ad8da5929">ab73d64f</a></li>
</ul>

<h2>Runtime Behavior Changes</h2>

<ul>
<li>  util-slf4j-api: Update the Logger API to include &ldquo;call-by-name&rdquo; method
variations akin to the Logging trait. When creating a Logger from a
Scala singleton object class, the resultant logger name will no longer include
the \$ suffix. Remove the deprecated Loggers object which is no longer
needed for Java compatibility as users can now directly use the Logger
apply functions with no additional ceremony. <a href="https://github.com/twitter/util/commit/cd99f16542959d926d43a5f5b498c2627038664b">cd99f165</a></li>
<li>  util: Bump version of Caffeine to 2.9.3. <a href="https://github.com/twitter/util/commit/07b5c2ef2f7843cc1c8e3cf7b017a98ee1f0d0bc">07b5c2ef</a></li>
</ul>

<h2>Breaking API Changes</h2>

<ul>
<li>  util-core: The c.t.util.Responder trait has been removed. <a href="https://github.com/twitter/util/commit/88d3c95a30888d26f1c9bf8f6bf3b2d7f5e80ec2">88d3c95a</a></li>
</ul>

<h1><a href="https://github.com/twitter/scrooge/">Scrooge</a></h1>

<h2>New Features</h2>

<ul>
<li>  scrooge-core: c.t.scrooge.ThriftStructCodec.forStructClassTag API for retrieving
the codec for a struct or union class given a class tag or manifest and
c.t.scrooge.ThriftStructMetadata.forStructClassTag for retrieving its metadata.
<a href="https://github.com/twitter/scrooge/commit/ba1a97bc9549416b1d34e7c1550c38386bdaab42">ba1a97bc</a></li>
<li>  scrooge-core: c.t.scrooge.ThriftStructCodec.forStructClass API for retrieving codec
for a struct or union class and c.t.scrooge.ThriftStructMetadata.forStructClass for
similarly retrieving its metadata. <code>PHAB_ID=_D825675</code></li>
<li>  scrooge-generator: for each method defined in a service in the Thrift IDL, if any request arg
of a method has annotations started with validation., generate a new trait
ServerValidationMixin with a new API violationReturning&lt;method_name&gt; which validates incoming
request (of Struct, Union, Exception types) and return any violations (as method parameters
&lt;request_variable&gt;Violations) back to the users in the method API. <a href="https://github.com/twitter/scrooge/commit/aa83a3f5886cae3d4ef96f379192d906daaab7a7">aa83a3f5</a></li>
</ul>

<h2>Breaking API Changes</h2>

<ul>
<li>  scrooge-generator: the c.t.scrooge.frontend.ThriftParser now always throws exceptions
rather than warnings when a fieldname matches a reserved keyword. See
c.t.scrooge.frontend.ThriftKeywords for the full list of disallowed
keywords. <a href="https://github.com/twitter/scrooge/commit/33767856287a8fadcf3838478889909cf0c08bfb">33767856</a></li>
</ul>

<h1><a href="https://github.com/twitter/finagle/">Finagle</a></h1>

<h2>New Features</h2>

<ul>
<li>  finagle-logging: Introduced finagle-logging, a new module for SLF4J-integrated
filters. <a href="https://github.com/twitter/finagle/commit/0e6a3b681f3a6988728d518dbd355b193164bfd3">0e6a3b68</a></li>
<li>  finagle-logging: Introduced SlowTracesFilter, which observes your requests and
logs the slowest ones that are also sampled for tracing. <a href="https://github.com/twitter/finagle/commit/0e6a3b681f3a6988728d518dbd355b193164bfd3">0e6a3b68</a></li>
<li>  finagle-core: Introduced MinSendBackupAfterMs to the stack param Configured in
BackupRequestFilter and propagated changes to MethodBuilder by adding new versions of idempotent
function. When traffic load is low, this is useful to increase the delay when backup requests are
sent and prevent the client from sending unnecessary backup requests. <a href="https://github.com/twitter/finagle/commit/b0b8a6bb321f8ec528457bd7da43ad705216d178">b0b8a6bb</a></li>
<li>  finagle-core: Added a new annotation clnt/has_dark_request in tracing and Finagle
Local context. The new annotation can be used to indicate whether or not the request
has a span that is sent to dark service. <a href="https://github.com/twitter/finagle/commit/dab1e48d03336a50820c1c7419d1683f9b67f004">dab1e48d</a></li>
</ul>

<h2>Bug Fixes</h2>

<ul>
<li>  finagle-netty4-http: On a Request, adding multiple cookies with the same name
to a CookieMap preserves all of them. Only cookies on Responses are
deduplicated. Previously, adding a Request cookie with the same name would
overwrite the old value with the new value. <a href="https://github.com/twitter/finagle/commit/6a49bfda74f433fa2b9cc2dca71c350e10cb6bc9">6a49bfda</a></li>
<li>  finagle-postgres: Fixed a bug where a single framer instance was shared across all
connections to a host when using TLS. <a href="https://github.com/twitter/finagle/commit/185e21158aaea876f82d5878e1d701bd0dc497c0">185e2115</a></li>
</ul>

<h2>Breaking API Changes</h2>

<ul>
<li>  finagle-core: Changed the shouldInvoke parameter in method serviceConcurrently
and sendDarkRequest in AbstractDarkRequestFilter to be a Boolean instead of a
function of (Req =&gt; Boolean). <a href="https://github.com/twitter/finagle/commit/dab1e48d03336a50820c1c7419d1683f9b67f004">dab1e48d</a></li>
<li>  finagle-core: Renamed the existing clnt/dark_request to clnt/is_dark_request in
c.t.finagle.filter.DarkTrafficFilter<a href="https://github.com/twitter/finagle/commit/dab1e48d03336a50820c1c7419d1683f9b67f004">dab1e48d</a></li>
</ul>

<h2>Runtime Behavior Changes</h2>

<ul>
<li>  finagle: Bump version of Caffeine to 2.9.3. <a href="https://github.com/twitter/finagle/commit/c42cea2c7b7c3bfaede6724fc3466d315952e89f">c42cea2c</a></li>
<li>  finagle: Upgrade to Netty 4.1.73.Final and netty-tcnative 2.0.46.Final.<a href="https://github.com/twitter/finagle/commit/cccbae40f6139eb15009d5dfc1f4c47ddba15862">cccbae40</a></li>
<li>  finagle-core: in TimeoutFilter, only transform a timeout exception caused by TimeoutFilter. This also
changes the type of exception raised by the TimeoutFilter from a java.util.concurrent.TimeoutException
to a com.twitter.finagle.RequestTimeoutException. <a href="https://github.com/twitter/finagle/commit/6a95f37d36db9f22908e571ecda342e9b62290fc">6a95f37d</a></li>
<li>  finagle-mux: Exceptions raised when Mux negotiation has failed have been
moved to a Debug log level as the stack trace is generally long and not
necessarily helpful. The logged message now includes the remote address and
that is logged at both the Debug level (with the exception and stack trace)
and Warning level (without). <a href="https://github.com/twitter/finagle/commit/712878ef392c2304fc371d4c439546702f1c18cd">712878ef</a></li>
<li>  finagle-core: c.t.f.ssl.SslConfigurations.initializeSslContext now creates an engine which includes TLSv1.3 as a supported protocol. <a href="https://github.com/twitter/finagle/commit/cc6c9db8afb615600950a201043c8b89eb4833eb">cc6c9db8</a></li>
<li>  finagle-netty4: c.t.f.n.ssl.client.Netty4ClientSslConfigurations.createClientContext and c.t.f.n.ssl.server.Netty4ServerSslConfigurations.createServerCont
ext now create contexts using the provided cipher suites. <a href="https://github.com/twitter/finagle/commit/9c6898efbc885629b0a6b073c9ab39910473ccf8">9c6898ef</a></li>
</ul>

<h1><a href="https://github.com/twitter/twitter-server/">Twitter Server</a></h1>

<p>No Changes</p>

<h1><a href="https://github.com/twitter/finatra/">Finatra</a></h1>

<ul>
<li><p>inject-modules: Deprecate c.t.inject.modules.LoggerModule. Update c.t.inject.app.App to
mix in the util/util-slf4j-jul-bridge Slf4jBridge trait. The LoggerModule does
not provide a solution inline with the best practices for bridging JUL to the SLF4J-API
and users are encouraged to instead mix in the c.t.util.logging.Slf4jBridge into the
main class of their application if necessary. The updates to c.t.inject.app.App will now
properly bridge JUL to the SLF4J-API early in the constructor of the application catching any
log messages emitted to JUL before where the bridging would have been attempted when using
the LoggerModule.</p>

<p>Note that Slf4jBridge trait is already mixed into the c.t.server.TwitterServer trait and
thus no further action is necessary forbridging JUL to the SLF4J-API in extensions of
c.t.server.TwitterServer. <a href="https://github.com/twitter/finatra/commit/83360745f91ee5dace446c99378c64c76dc0b6b9">83360745</a></p></li>
<li><p>inject-slf4j: Deprecate c.t.inject.logging.Logging trait and methods. Users are encouraged
to use the c.t.util.logging.Logging trait directly. There are no replacements for
c.t.inject.logging.Logging#debugFutureResult and c.t.inject.logging.Logging#time.
<a href="https://github.com/twitter/finatra/commit/084257a95dc529b6ef71a47c9bd1f44b7d26bc74">084257a9</a></p></li>
</ul>

</div>
</div>

      <hr>
      <!-- footer -->
      <div class="footer pull-right">
        <p>&copy; 2014‚Äì2019 <a href="https://twitter.com/">Twitter, Inc.</a> and other contributors
      </div><!-- /footer -->
    </div><!-- /container -->
  </body>
</html>
